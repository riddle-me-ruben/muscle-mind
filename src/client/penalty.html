<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/timer.css">
    <link rel="icon" href="{{ url_for('static', filename='logo.png') }}" type="image/x-icon">
    <title>Penalty</title>
</head>
<body>
    <h1 id="exercise-message"></h1>
    
    <div id="timer">10 seconds remaining</div> <!-- Timer display -->
    
    <!-- Image for the exercise (GIF) -->
    <img id="exercise-gif" src="" alt="Exercise GIF" style="width: 500px; height: auto; margin-top: 20px;">

    
    <div class="pushup-container">
        <div class="pushup-person">
            <div class="pushup-body"></div>
            <div class="pushup-head"></div>
        </div>
        <div class="pushup-ground"></div>
    </div>
    
    <!-- JavaScript for Countdown Timer, Random Exercise, and Conditional Redirection -->
    <script>
        // List of exercises and their corresponding GIF URLs
        const exercises = [
            { name: "Do 5 situps", gif: "/static/situps.gif" },
            { name: "Do 10 jumping jacks", gif: "/static/jumping-jacks.gif" },
            { name: "Do 5 burpees", gif: "/static/burpees.gif" },
            { name: "Do 5 squats", gif: "/static/squats.gif" }
        ];

        // Randomly select an exercise and display it
        const selectedExercise = exercises[Math.floor(Math.random() * exercises.length)];
        document.getElementById("exercise-message").innerText = selectedExercise.name;
        
        // Show the corresponding GIF
        const gifElement = document.getElementById("exercise-gif");
        gifElement.src = selectedExercise.gif;

        // Timer setup
        let timeLeft = 10; // Set countdown time in seconds
        const timerElement = document.getElementById("timer");

        // URLs for next question or score page
        const nextQuestionUrl = "{{ url_for('take_quiz_route', quiz_id=quiz_id, question_num=question_num + 1) }}";
        const scoreUrl = "{{ url_for('score_route', quiz_id=quiz_id, score=score, total=total_questions) }}";
        
        // Inject Flask variables into JavaScript
        const questionNum = {{ question_num }};
        const totalQuestions = {{ total_questions }};
        
        // Determine if this is the last question
        const isLastQuestion = questionNum >= totalQuestions - 1;

        // Immediately update the display before starting the interval
        timerElement.innerText = timeLeft + " seconds remaining";

        const countdown = setInterval(() => {
            timeLeft -= 1;
            if (timeLeft <= 0) {
                clearInterval(countdown);
                // Redirect based on whether it's the last question or not
                window.location.href = isLastQuestion ? scoreUrl : nextQuestionUrl;
            } else {
                timerElement.innerText = timeLeft + " seconds remaining";
            }
        }, 1000);
    </script>
</body>
</html>
